---
title: "課堂練習20190925"
author: "曾雨晴"
date: "9/25/2019"
output: html_notebook
---
```{r basic setup, message=FALSE, echo=TRUE, eval=T}
library(dplyr); library(stringr); library(ggplot2); library(plotly); library(lubridate); library(readr); library(tidyr); library(showtext)

font_add("QYuan","C:/Users/User/Downloads/cwTeXQYuan-Medium.ttf") # 新增字體
showtext_auto(enable=TRUE) #啟用字體
theme_set(theme_classic())
knitr::opts_chunk$set(out.width='80%', fig.asp=.75, fig.align='center', fig.showtext=T)
```

####gather and spread
### gather
```{r}
df_gatherExample <- data.frame(
  country=c("A","B","C"),
  `1999`=c("0.7k","37k","212k"),#如果要用數字開頭就要用反頓點
  `2000`=c("2k","80k","213k"),
  check.names = F
)
df_gatherExample
```
##將collegeData裡各年級男女生人數合成兩個欄位，類別,人數，其中類別值為原始欄位名稱（即一年級男生，一年級女生，…等等），而人數則為對應人數。
```{r}
df_gatherExample
gather(df_gatherExample,
       `1999`,`2000`,
       key="年份",value="人口")
```

```{r}
library(readr)
collegeData <- read_csv("https://raw.githubusercontent.com/tpemartin/github-data/master/103_student.csv")
```

```{r}
collegeData%>%
  gather(
  contains("生"),
  key="類別",value="人數")->collegeDataGather
```
##桃園各地區每月結婚對數：
```{r}
library(readr)
df_taoyuanMarriage <- read_csv("https://data.tycg.gov.tw/opendata/datalist/datasetMeta/download?id=f95d1a33-ec56-44c5-a9ec-3afba8157e39&rid=fd2070ef-7431-4f9c-bc3a-82d7bfbcd2fb")
```
#將資料「一～十二月」縮排在月份變數，而其下的對應值縮排在對數變數。
```{r}
df_taoyuanMarriage%>%
  gather(
    ends_with("月"),
    key="月份",value="對數"
  )->df_taoyuanMarriageGather
```
#計算每個月份桃園總結婚對數。
```{r}
df_taoyuanMarriageGather%>%
  group_by(月份)%>%
  summarise(
    總結婚對數=sum(對數)
  )->df_taoyuanMarriageGather_all
```
#找出每個地區結婚最高峰月份。
